IPv4 (Internet Protocol version 4) is the original and still‐dominant protocol at the Internet (network) layer of the TCP/IP suite. It defines a 32‑bit logical address space (≈4.3 billion addresses) for hosts and routers ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IPv4%20addresses%20are%20composed%20of,known%20as%20%E2%80%9Cdotted%20decimal%E2%80%9D%20notation)).  IPv4 is **connectionless and stateless** – each packet (“datagram”) is treated independently and forwarded hop-by-hop based on its destination IP in the header ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IP%20operates%20on%20a%20simple,understanding%20of%20the%20network%E2%80%99s%20state)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20Internet%20Protocol%20is%20the,destination%20host%20on%20another%20network)).  Routers examine the destination address and forward the packet to the next hop on the path to its destination ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20Internet%20Protocol%20is%20the,destination%20host%20on%20another%20network)).  Error detection/recovery (if any) is left to higher layers (e.g. TCP); IPv4 provides only best-effort delivery ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=The%20design%20of%20IP%20also,also%20simplifies%20the%20task%20of)).

- **32‑bit address:** IPv4 uses four 8-bit octets (dotted-decimal). Each address identifies a host interface on a network ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IPv4%20addresses%20are%20composed%20of,known%20as%20%E2%80%9Cdotted%20decimal%E2%80%9D%20notation)) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=%2A%2032,routers%20along%20the%20route%20if)).  
- **Address space:** The theoretical total is 2^32 (≈4.3×10^9) unique addresses ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IPv4%20addresses%20are%20composed%20of,known%20as%20%E2%80%9Cdotted%20decimal%E2%80%9D%20notation)).  (By 2011 this pool was fully allocated, driving adoption of IPv6 ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=Protocol%29.%20,as%20IPSec%20for%20secure%20communications)).)  
- **Layer:** IPv4 is the Internet layer protocol (sometimes called the Network layer). It runs on top of link-layer (Ethernet, Wi-Fi, etc.) and below transport (TCP/UDP).  
- **Stateless, connectionless:** No per-session state is kept in the network. Every packet is routed independently based on its header (no virtual circuit) ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IP%20operates%20on%20a%20simple,understanding%20of%20the%20network%E2%80%99s%20state)).  This connectionless model avoids per-flow overhead but means IPv4 by itself does not guarantee delivery.  
- **Function:** Primary functions are _logical addressing_ (assigning unique IPs to hosts) and _routing_ (forwarding packets). Routers use IP addresses to determine the next hop toward the destination network ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20Internet%20Protocol%20is%20the,destination%20host%20on%20another%20network)).  
- **Reliance on ARP:** On a local link, IPv4 uses Address Resolution Protocol (ARP) to map IP addresses to physical MAC addresses ([What is IPv4? | GeeksforGeeks](https://www.geeksforgeeks.org/what-is-ipv4/#:~:text=,map%20to%20the%20MAC%20address)).  The router or host broadcasts an ARP request to learn the MAC of the next-hop device.

#### Quick Notes:
- IPv4 introduced in 1982–83 and still carries most Internet traffic today ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Internet%20Protocol%20version%204%20,2%20%5D%20its%20successor)).  
- It uses a 20-byte header (minimum) and optional fields (up to 60 bytes) for packet metadata.  
- Designed for a *best-effort* Internet; it includes a Time-To-Live (TTL) to limit loops and performs no automatic retransmission.  

## IPv4 Packet Structure and Header Fields

An IPv4 packet consists of a header (normally 20 bytes) followed by payload data.  The header contains fields for version, length, addressing, routing, fragmentation, and more.  The first 20 bytes (5 × 32‑bit words) are mandatory; options (if any) extend it up to 60 bytes. The IPv4 header fields are:
![[Pasted image 20250427201715.png]]
 ([IPv4 Packet Header](https://networklessons.com/cisco/ccna-routing-switching-icnd1-100-105/ipv4-packet-header)) *Figure: IPv4 packet header fields (20–60 bytes). Key fields include Version, IHL, Type of Service, Total Length, Identification, Flags/Fragment Offset, TTL, Protocol, Header Checksum, and Source/Destination addresses.*

- **Version (4 bits):** Protocol version = 4 for IPv4 ([IPv4 Packet Header](https://networklessons.com/cisco/ccna-routing-switching-icnd1-100-105/ipv4-packet-header#:~:text=,There%20are%208%20bits)).  
- **IHL (Header Length, 4 bits):** Number of 32-bit words in the header. Minimum is 5 (20 bytes); maximum is 15 (60 bytes) if options are present ([IPv4 Packet Header](https://networklessons.com/cisco/ccna-routing-switching-icnd1-100-105/ipv4-packet-header#:~:text=,IHL)).  
- **Type of Service / DSCP (8 bits):** Originally for QoS (precedence/TOS); now commonly used as Differentiated Services Code Point (DSCP) and ECN flags ([IPv4 Packet Header](https://networklessons.com/cisco/ccna-routing-switching-icnd1-100-105/ipv4-packet-header#:~:text=,There%20are%208%20bits)). This field can mark priority or congestion control levels.  
- **Total Length (16 bits):** Total packet length (header + data) in bytes. Since it is 16 bits, the maximum length is 65,535 bytes ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Total%20Length%3A%2016%20bits%20This,performed%20at%20the%20receiving%20host)).  (The minimum is 20 bytes if no data.)  
- **Identification (16 bits):** A unique ID for fragmentation. All fragments of one original datagram carry the same ID ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Identification%3A%2016%20bits%20This%20field,trace%20datagrams%20with%20spoofed%20source)), allowing the destination to reassemble them into the original packet.  
- **Flags (3 bits):** Control fragmentation:  
  - **DF (Don't Fragment, 1 bit):** If set, packet must not be fragmented ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Flags%3A%203%20bits%20There%20are,flags%20defined%20within%20this%20field)).  A router encountering a packet too large to forward (MTU smaller) with DF=1 drops it and usually sends an ICMP “fragmentation needed” message (used in Path MTU Discovery).  
  - **MF (More Fragments, 1 bit):** For fragmented packets, all fragments except the last have MF=1 ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=For%20unfragmented%20packets%2C%20the%20MF,differentiated%20from%20an%20unfragmented%20packet)). The last (or only) fragment has MF=0. This tells the receiver when it has all fragments.  
- **Fragment Offset (13 bits):** If the packet is fragmented, this specifies where this fragment belongs in the original packet, in 8-byte units ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Fragment%20Offset%3A%2013%20bits%20This,maximum%20IP%20length%20of%2065%2C535)).  (Offsets are multiples of 8 bytes, so packets are split on 8-byte boundaries.) Because it is 13 bits, the maximum offset value is 8191, allowing a maximum original size of up to (8191×8) + 20 = 65,548 bytes (slightly over the 65,535-byte limit) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=except%20the%20last%2C%20which%20may,maximum%20IP%20length%20of%2065%2C535)).  (Offsets of 0 and MF=0 indicate an unfragmented packet.)  
- **Time To Live (TTL, 8 bits):** Maximum hop count. Each router that forwards the packet decrements TTL by 1; if TTL reaches 0, the packet is dropped.  This prevents packets looping forever. The initial TTL is set by the sender (commonly 64 or 128).  
- **Protocol (8 bits):** Indicates the encapsulated transport protocol (e.g. 1=ICMP, 6=TCP, 17=UDP, etc.). The IPv4 header checksum does **not** cover the payload, only these header fields.  
- **Header Checksum (16 bits):** A checksum covering only the IPv4 header (not the data). Routers recompute this when the header changes (e.g. TTL decrement). It catches errors in header transmission.  
- **Source Address (32 bits):** The IPv4 address of the sender.  
- **Destination Address (32 bits):** The IPv4 address of the intended recipient.  
- **Options (variable, up to 40 bytes):** Optional extensions (e.g. security, routing, timestamp). If present, they follow the main header; the IHL field accounts for them.

#### Quick Notes:
- The **minimum header** is 20 bytes (IHL=5); with no options this covers most fields. Options (if used) make IHL >5.  
- The **maximum packet size** on IPv4 links is 65,535 bytes (including header) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Total%20Length%3A%2016%20bits%20This,performed%20at%20the%20receiving%20host)).  Hosts typically send smaller packets (Ethernet MTU ~1500 bytes).  
- **Fragmentation:** Any host/router can split an oversized packet into fragments, all sharing the same Identification. The receiver reassembles fragments into the original packet. If DF=1 is set, fragmentation is prohibited and the router will drop the packet (triggering ICMP).  
- **Checksum:** Only protects the header; any change (like TTL decrement) requires recomputing it.  

## IP Addressing Classes

Originally, IPv4 addresses were divided into classes A–E based on the high-order bits of the first octet.  This *classful* scheme fixed default network/host boundaries (now obsolete after CIDR, but still worth understanding):

- **Class A (1.0.0.0 – 126.255.255.255)**: Leading bit pattern `0` (0xxx.xxxx).  Default mask 255.0.0.0 (/8).  The first 8 bits are network ID, and remaining 24 bits are host ID ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,A%20has%20a%20total%20of)).  This yields 2^24 addresses per Class A network (≈16.7 million), e.g. 1.0.0.0/8. (Note: 0.0.0.0/8 and 127.0.0.0/8 are reserved specials, not used as normal Class A networks.)  
- **Class B (128.0.0.0 – 191.255.255.255)**: Leading bits `10` (10xx.xxxx).  Default mask 255.255.0.0 (/16).  First 16 bits = network ID, last 16 bits = host ID ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,B%20has%20a%20total%20of)).  Each Class B supports 2^16–2 = 65,534 hosts.  There are 2^14 (16,384) possible Class B networks ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,B%20has%20a%20total%20of)).  
- **Class C (192.0.0.0 – 223.255.255.255)**: Leading bits `110` (110x.xxxx).  Default mask 255.255.255.0 (/24).  First 24 bits = network ID, last 8 bits = host ID ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,C%20has%20a%20total%20of)).  Each Class C supports 2^8–2 = 254 hosts.  There are 2^21 (2,097,152) possible Class C networks ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,C%20has%20a%20total%20of)).  
- **Class D (224.0.0.0 – 239.255.255.255)**: Leading bits `1110`. Reserved for **multicast** ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20address%20belonging%20to%20class,address%20that%20interested%20hosts%20recognize)) (not for ordinary host addresses).  There is no network/host division (all addresses in 224.0.0.0/4 represent multicast groups).  
- **Class E (240.0.0.0 – 255.255.255.255)**: Leading bits `1111`. Reserved for future/experimental use ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20addresses%20belonging%20to%20class,of%20the%20first%20octet%20of)).  These are not publicly assigned.

Key points about classes:

- **Network vs Host bits:**  Class A gives many hosts per network, class B moderate, class C few.  For example, Class A (1/8) had 16.7M host addresses ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,A%20has%20a%20total%20of)), while Class C (1/24) only 254.  
- **Reserved Blocks:**  `127.x.x.x` (loopback) is reserved from Class A ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20class%20A%20network%20127,destination%20address%20must%20be%20dropped)), and `0.x.x.x` is reserved for the “current network” (source address meaning this host) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Special%20address%20blocks%20%20Address,network%5B%204)).  224/4 (Class D) and 240/4 (Class E) are special as above ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20address%20belonging%20to%20class,address%20that%20interested%20hosts%20recognize)) ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20addresses%20belonging%20to%20class,of%20the%20first%20octet%20of)).  
- **Classful Decline:** Classful addressing was inflexible and wasteful (e.g. a Class C only had 254 hosts even if fewer were needed). It was effectively replaced by CIDR in 1993 ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20problem%20with%20this%20classful,Class%20E%20addresses%20are%20reserved)) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=A%20system%20called%20Classless%20Inter,the%20routing%20or%20networking%20portion)).  Modern networks use variable-length prefixes instead of fixed classes.  

#### Quick Notes:
- **Default masks:** Class A:/8, B:/16, C:/24.  (Ex: IP 10.5.3.12 default mask 255.0.0.0；IP 172.16.4.5 mask 255.255.0.0.)  
- **Address counts:** In Class A: 2^24–2 hosts (16,777,214) ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,A%20has%20a%20total%20of)); Class B: 2^16–2 (65,534) ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,B%20has%20a%20total%20of)); Class C: 2^8–2 (254) ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=The%20higher,C%20has%20a%20total%20of)).  (Subtracting 2 excludes network/broadcast IDs.)  
- **Classes D/E:** Not for unicast (D=multicast ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20address%20belonging%20to%20class,address%20that%20interested%20hosts%20recognize)), E=reserved ([Introduction of Classful IP Addressing | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-of-classful-ip-addressing/#:~:text=IP%20addresses%20belonging%20to%20class,of%20the%20first%20octet%20of))).  Class D addresses (224.0.0.0/4) are strictly for IPv4 multicast groups.  
- **Classful vs Classless:** After 1993 all new IPv4 allocation uses CIDR (see next section), though “classful” knowledge helps interpret legacy defaults.  

## Advanced Subnetting

Subnetting is the process of dividing a larger IPv4 network into smaller subnetworks by extending the network prefix.  In practice, one “borrows” bits from the host portion of the address to create additional network bits. Each borrowed bit doubles the number of subnets but halves hosts per subnet ([Introduction To Subnetting | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-to-subnetting/#:~:text=1,number%20of%20usable%20hosts%20decreases)).

Key concepts and steps:

- **Subnet mask and prefix:** A subnet mask (or CIDR prefix) indicates how many leading bits are *fixed as network ID*. For example, /24 means the first 24 bits are network, leaving 8 host bits.  
- **Borrowing bits:** To create subnets, choose additional bits from the host part.  E.g. to split a /24 into 4 subnets, borrow 2 bits (since 2^2=4) ([Introduction To Subnetting | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-to-subnetting/#:~:text=1,number%20of%20usable%20hosts%20decreases)), making new prefix /26.  
- **Calculations:**  
  - *Number of subnets* = 2^(number of borrowed bits).  
  - *New mask* = original mask + (borrowed bits).  In dotted form, each borrowed bit changes the mask octets accordingly.  
  - *Addresses per subnet* = 2^(remaining host bits) = 2^(32 – new_prefix).  
  - *Usable hosts per subnet* = 2^(remaining host bits) – 2 (subtract network and broadcast IDs).  
- **Subnetwork IDs:**  The first IP in each subnet (all host bits 0) is the *network address* (not assignable).  The last IP (all host bits 1) is the *broadcast address* for that subnet ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20first%20address%20in%20a,address%20always%20ends%20in%20255)).

**Worked Example:** Divide the network `192.168.1.0/24` into 4 equal subnets.  

1. **Identify original:** `192.168.1.0/24` has mask 255.255.255.0. It has 8 host bits and 256 addresses (254 usable hosts).  
2. **Borrow bits:** We want 4 subnets. 4 = 2^2, so borrow 2 bits.  New prefix = 24 + 2 = **/26** (mask 255.255.255.192). ([Introduction To Subnetting | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-to-subnetting/#:~:text=1,number%20of%20usable%20hosts%20decreases))  
3. **Addresses per subnet:** /26 ⇒ 32 addresses each (2^6 = 64 total, 62 usable).  
4. **List subnets:**  
   - Subnet 1: `192.168.1.0/26` (addresses .0–.63; .0=network ID, .63=broadcast). Usable hosts .1–.62.  
   - Subnet 2: `192.168.1.64/26` (addresses .64–.127; .64 net ID, .127 broadcast). Hosts .65–.126.  
   - Subnet 3: `192.168.1.128/26` (addresses .128–.191; hosts .129–.190).  
   - Subnet 4: `192.168.1.192/26` (addresses .192–.255; hosts .193–.254).  

Each /26 has `2^6 – 2 = 62` usable hosts. As expected, dividing a /24 (/24→/26) quadruples subnets and halves hosts per subnet ([Introduction To Subnetting | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-to-subnetting/#:~:text=1,number%20of%20usable%20hosts%20decreases)).

- **Formula:** In general, **usable hosts = 2^(32 – prefix) – 2**. For instance, a /26 has 32 total addresses (2^(32–26) = 64) and thus 62 usable hosts (64–2).  

**Key Points:** Subnetting lets networks be sized to fit needs, reducing wasted addresses.  A larger prefix (/27, /28, etc.) means more, smaller subnets. Borrowing one more bit (e.g. /27 instead of /26) doubles subnets and halves hosts each time. Always account for the two reserved addresses per subnet (all‑zeros and all‑ones). Note that a `/31` mask (255.255.255.254) yields 2 addresses and is a special case used for point-to-point links (RFC 3021) where no traditional broadcast is needed.

#### Quick Notes:
- **Subnet formula:**  Addresses in a /n network = 2^(32–n).  Usable hosts = 2^(32–n) – 2 (except /31 and /32).  
- **Borrowing:** Each borrowed bit = ×2 subnets. E.g. /24 →/25 makes 2 subnets; /24 →/26 makes 4, etc. ([Introduction To Subnetting | GeeksforGeeks](https://www.geeksforgeeks.org/introduction-to-subnetting/#:~:text=1,number%20of%20usable%20hosts%20decreases)).  
- **Subnet addresses:** First address is the *subnet ID* (all host bits 0) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20first%20address%20in%20a,address%20always%20ends%20in%20255)). Last address is the *broadcast* (all host bits 1).  
- **Host addresses:** Hosts may use any address in between (e.g. 192.168.5.1–192.168.5.254 in a /24) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20first%20address%20in%20a,address%20always%20ends%20in%20255)).  

## CIDR (Classless Inter-Domain Routing)

Classless Inter-Domain Routing (CIDR) replaced classful allocation in 1993 ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=A%20system%20called%20Classless%20Inter,the%20routing%20or%20networking%20portion)).  CIDR allows arbitrary-length prefixes (not tied to class boundaries) and aggregates contiguous networks. Instead of class A/B/C, IPv4 uses a notation like `A.B.C.D/N`, where `N` is the prefix length (number of network bits).

- **Flexibility:** CIDR means you can have, for example, a /22, /19, /30 network—any prefix 0≤N≤32.  This prevents the waste of fixed classes and allows route aggregation.  
- **Notation:** Write IPs with `/N` to indicate the network portion. E.g. `192.168.0.15/24` means mask 255.255.255.0 (first 24 bits network) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=For%20example%2C%20we%20could%20express,significant%20for%20the%20network%20routing)). In contrast, `192.168.0.0/23` covers 192.168.0.0–192.168.1.255 (two /24 blocks) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=However%2C%20using%20CIDR%20notation%2C%20we,that%20we%20are%20referring%20to)).  
- **Supernets/Aggregation:** Adjacent networks can be summarized.  For example, two /24 networks 192.168.0.0/24 and 192.168.1.0/24 can be represented as one `/23` (prefix 23) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=However%2C%20using%20CIDR%20notation%2C%20we,that%20we%20are%20referring%20to)). This merges them into a single block with 23 network bits, halving the prefix. The netmask 255.255.254.0 indicates the first 23 bits are fixed; the 24th bit can be 0 or 1 ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=The%20CIDR%20address%20we%20specified,or)).  
- **Routing Efficiency:** CIDR dramatically reduces global routing table size, since many classful-sized routes became one route (e.g. 2000+ Class C routes could be aggregated into one /19).  It also allowed more efficient address allocation (prefixes sized to fit organizations).  
- **Address count by prefix:** Number of addresses = 2^(32–N).  For instance, a `/23` has 2^(32–23) = 512 total addresses (510 usable) ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=However%2C%20using%20CIDR%20notation%2C%20we,that%20we%20are%20referring%20to)).  

**Example:** Using CIDR, an ISP might advertise `203.0.113.0/24` and `203.0.114.0/24` as a single `203.0.113.0/23` ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=However%2C%20using%20CIDR%20notation%2C%20we,that%20we%20are%20referring%20to)).  Any packet to 203.0.113.0–203.0.114.255 matches that prefix.  Internally, that /23 has mask 255.255.254.0, meaning the first 23 bits (203.0.113) identify the network ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=The%20CIDR%20address%20we%20specified,or)). 

- **No inherent classes:** All routes and addresses are *classless*.  The “class” letters (A, B, C) are irrelevant except as a shorthand (e.g. “/16 is a Class B default mask”). CIDR freed IPv4 from rigid classes ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=A%20system%20called%20Classless%20Inter,the%20routing%20or%20networking%20portion)).  

#### Quick Notes:
- CIDR uses slash notation (`/N`) for the prefix length. For example, `/24`=255.255.255.0, `/16`=255.255.0.0, etc.  
- A shorter prefix (smaller N) is a **larger network**. E.g. /22 (255.255.252.0) has 1024 addresses; /26 (255.255.255.192) has 64 addresses.  
- CIDR allows **supernetting**: contiguous blocks can share one summary route ([Understanding IP Addresses, Subnets, and CIDR Notation for Networking | DigitalOcean](https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#:~:text=However%2C%20using%20CIDR%20notation%2C%20we,that%20we%20are%20referring%20to)). This is a cornerstone of modern IPv4 routing.  

## IPv4 Fragmentation and Reassembly

When an IPv4 packet traverses networks with different MTUs (Maximum Transmission Units), it may need to be fragmented.  Fragmentation breaks a large datagram into smaller pieces so each fits the next link’s MTU. The key points are:

- **Who fragments:** Either the original sender or an intermediate router will fragment the packet if it is larger than the outgoing link’s MTU (provided DF=0) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=datagrams%20must%20be%20fragmented,performed%20at%20the%20receiving%20host)).  The destination host is responsible for reassembling all fragments back into the original packet.  
- **Identification field:** Each fragment of the same original packet carries the same 16-bit Identification number ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Identification%3A%2016%20bits%20This%20field,trace%20datagrams%20with%20spoofed%20source)).  This allows the receiver to group fragments by packet.  
- **Flags:** The **MF** (More Fragments) flag indicates if there are more fragments following. All fragments except the last have MF=1 ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=For%20unfragmented%20packets%2C%20the%20MF,differentiated%20from%20an%20unfragmented%20packet)). The last fragment has MF=0.  The **DF** (Don't Fragment) flag, if set, tells routers not to fragment the packet. If DF=1 and a packet is too big, it is dropped (router typically sends an ICMP “fragmentation needed” message back).  
- **Fragment offset:** Specifies the position of this fragment’s data relative to the start of the original packet, in 8-byte units ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Fragment%20Offset%3A%2013%20bits%20This,maximum%20IP%20length%20of%2065%2C535)).  (Thus fragment sizes are multiples of 8 bytes, except possibly the last fragment.)  The 13-bit offset field can range 0–8191, allowing original packets up to (8191×8 + header) ≈ 65548 bytes ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=except%20the%20last%2C%20which%20may,maximum%20IP%20length%20of%2065%2C535)).  
- **MTU discovery:** To avoid fragmentation, hosts often use Path MTU Discovery – sending packets with DF=1 and adjusting size based on feedback.  Nonetheless, routers may still fragment when needed.  

**Illustration:**  Suppose you have a 4000-byte IPv4 packet entering a network with MTU 1500.  The packet (20-byte header + 3980 bytes data) must be split.  Each fragment will carry a 20-byte header plus up to 1480 bytes of data (1480 is the largest multiple of 8 ≤ 1500–20).  So the packet splits into 3 fragments: two carrying 1480 bytes of data (offsets 0 and 185, since 1480/8=185) and one carrying the remaining 1020 bytes (offset 370).  All fragments share the same Identification, MF=1 on the first two, and MF=0 on the last. The receiver reassembles them by offset.

#### Quick Notes:
- IPv4 routers can *and will* fragment packets (if DF=0) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=datagrams%20must%20be%20fragmented,performed%20at%20the%20receiving%20host)). The end host reassembles based on Identification, offset, and MF flag.  
- A **maximum datagram size** is 65,535 bytes.  Offsets (13 bits) allow that full range by fragmenting.  (Note: IPv6 forbids in-network fragmentation, requiring hosts to perform MTU discovery instead.)  
- Fragmentation can hurt performance; it’s best avoided when possible (e.g. by using PMTUD and sending smaller packets).  

## Private vs Public IPv4 Addresses

IPv4 reserves certain address blocks for private (non‑routable) use ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=network,Used%20for%20%20215%20link)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Reserved%20private%20IPv4%20network%20ranges,of%20256%20Class%20C%20blocks)). Hosts on private networks use these and rely on NAT to communicate externally. The three *RFC1918* private ranges are:

- **10.0.0.0/8:** (10.0.0.0 – 10.255.255.255, 16,777,216 addresses) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=network,8)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Reserved%20private%20IPv4%20network%20ranges,777%20216%20Single%20Class%20A)).  
- **172.16.0.0/12:** (172.16.0.0 – 172.31.255.255, 1,048,576 addresses) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=network,Used%20for%20%20215%20link)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=addresses%20Classful%20description%2024,of%2016%20Class%20B%20blocks)).  
- **192.168.0.0/16:** (192.168.0.0 – 192.168.255.255, 65,536 addresses) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=block%202002%3A%3A%2F16%29,8)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=20,of%20256%20Class%20C%20blocks)).  

Packets with these source or destination addresses are *not routed on the public Internet* ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Of%20the%20approximately%20four%20billion,routing%20gateway%20for%20this%20purpose)).  They are used only within private networks (corporate LANs, home networks, etc.).  Because multiple private networks can reuse the same addresses, Network Address Translation (NAT) is required at the boundary router to map private addresses to public ones. 

All other IPv4 addresses are *public* (routable) and are assigned by IANA/RIRs to ISPs or organizations.  For example, an ISP will give a user a public IP (often dynamic) to connect to the Internet.  Two hosts with only private IPs cannot talk directly over the Internet without NAT or a VPN.

### NAT and PAT

Due to IPv4 address exhaustion, **Network Address Translation (NAT)** is widely used ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)) ([Difference Between Network Address Translation (NAT) and Port Address Translation (PAT) | GeeksforGeeks](https://www.geeksforgeeks.org/difference-between-network-address-translation-nat-and-port-address-translation-pat/#:~:text=It%20is%20a%20Private%20IP,one%20relation)). NAT allows multiple devices with private IPs to share a single public IP address.  The router rewrites packet headers as follows:

- **Dynamic NAT/PAT:** When an inside host (e.g. 10.x.x.x) sends a packet out, the NAT router changes the source IP to its own public IP.  It records a mapping so that when the response returns, it can translate the destination back to the original private IP.  
- **PAT (Port Address Translation):** A form of NAT where many hosts share *one* public IP by using different TCP/UDP source port numbers ([Difference Between Network Address Translation (NAT) and Port Address Translation (PAT) | GeeksforGeeks](https://www.geeksforgeeks.org/difference-between-network-address-translation-nat-and-port-address-translation-pat/#:~:text=What%20is%20Port%20Address%20Translation,PAT)).  The router tracks each session by port number. This is common in home routers: all devices use the single ISP-given IP, distinguished by ports.  
- **Scope:** NAT hides the internal network (improving privacy/security) and conserves public addresses.  However, NAT breaks end-to-end connectivity (inbound connections must be forwarded by the router) and complicates protocols that embed IP addresses.  

**Example:** Home network with 3 devices. Without NAT, each device would need its own public IP to contact the Internet. With NAT/PAT, all can use the one public IP.  The router replaces each outgoing packet’s source IP with the shared public IP (and unique source port) ([Difference Between Network Address Translation (NAT) and Port Address Translation (PAT) | GeeksforGeeks](https://www.geeksforgeeks.org/difference-between-network-address-translation-nat-and-port-address-translation-pat/#:~:text=Consider%20a%20home%20network%20with,the%20request%20over%20the%20internet)). Replies coming back to the public IP are demultiplexed by port and delivered to the correct internal host. 

#### Quick Notes:
- **NAT vs PAT:** NAT can map one private IP to one public IP (one-to-one).  PAT (NAT overload) maps many private IPs to one public IP by using distinct port numbers ([Difference Between Network Address Translation (NAT) and Port Address Translation (PAT) | GeeksforGeeks](https://www.geeksforgeeks.org/difference-between-network-address-translation-nat-and-port-address-translation-pat/#:~:text=In%20Port%20Address%20Translation%20,It%20have%20two%20types)).  
- **Reason:** NAT was driven by IPv4 scarcity ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)). It conserves addresses and delays IPv4 exhaustion.  
- **Limitations:** NAT complicates peer-to-peer and inbound connections (port forwarding needed).  Also, high-end security attacks (e.g. IP spoofing) are not prevented by NAT alone.  

## IPv4 Routing Basics

IPv4 routing involves forwarding packets based on their destination IP’s network prefix. Routers maintain a routing table of network prefixes (CIDR blocks) and next-hop information. Key points:

- **Longest-Prefix Match:** When a packet arrives, the router finds the routing table entry whose prefix best matches the packet’s destination (longest prefix = most specific network) and forwards accordingly.  
- **Dynamic Protocols:** Routers learn routes via dynamic protocols (RIP, OSPF, EIGRP within an AS; BGP between ISPs) or via static configuration.  BGP is the core exterior routing protocol that exchanges route advertisements with IP prefixes on the Internet.  
- **Default Route:** Often a catch-all route (0.0.0.0/0) points to a default gateway if no more specific route matches.  
- **Intra vs Inter-AS:** Within a network (intra-AS), routers may use OSPF/EIGRP which usually treat IPs classlessly. Between networks (inter-AS), BGP also uses CIDR. There is no concept of “class” in routing tables.  
- **Link-Layer Integration:** On a local LAN, before forwarding to the next hop, the router uses ARP to resolve the next-hop IP to a MAC address ([What is IPv4? | GeeksforGeeks](https://www.geeksforgeeks.org/what-is-ipv4/#:~:text=,map%20to%20the%20MAC%20address)).  

#### Quick Notes:
- Packets are forwarded IP→next-hop iteratively, not all the way to destination in one go.  
- Routers strip the incoming Ethernet/Wi-Fi header and encapsulate the packet in a new link-layer frame on the outgoing interface, based on the next-hop’s MAC.  
- ICMP messages (e.g. TTL exceeded or “host unreachable”) inform senders of certain errors.

## Broadcast, Multicast, and Anycast (IPv4)

**Broadcast:** In IPv4, a broadcast address sends to *all hosts on the local network*. There are two types:  
- **Limited broadcast:** `255.255.255.255` (all ones) is the local network broadcast (not forwarded by routers).  Used rarely (e.g. DHCP clients use it to find a server when no IP is yet assigned). ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=240,destination%20address%5B%204))  
- **Directed broadcast:** The address with all host bits = 1 within a subnet (e.g. for 192.168.5.0/24, the directed broadcast is 192.168.5.255) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20first%20address%20in%20a,address%20always%20ends%20in%20255)).  Packets sent to a directed broadcast (from outside) will be delivered to all hosts in that subnet (if enabled by routers).  

**Multicast:** IPv4 *multicast* uses Class D addresses (224.0.0.0 through 239.255.255.255) ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=One%20of%20the%20differences%20between,255%20range%20for%20IP%20multicast)).  A multicast IP represents a group of receivers.  Multicast traffic is only delivered to hosts that have joined that group via IGMP.  Special IPv4 multicast examples include:  
- 224.0.0.1 = all-hosts group (on a LAN) ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=The%20224,recognize%20some%20of%20the%20protocols)).  
- 224.0.0.2 = all-routers group.  
- Protocol-specific: many routing protocols (e.g. OSPF, RIP) use specific link-local multicast addresses in 224.0.0.x ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=The%20224,recognize%20some%20of%20the%20protocols)).  
Unlike broadcast, multicast addresses are not sent to *all* hosts by default – only those subscribed.

 ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses)) *Figure: IPv4 multicast (Class D) address format.  Any address whose first octet starts with binary 1110 (224–239) is a multicast address ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=One%20of%20the%20differences%20between,255%20range%20for%20IP%20multicast)).*  

**Anycast:** IPv4 anycast is not a separate address range; rather, it is a routing methodology.  Multiple hosts (often servers) are configured with the same unicast IPv4 address. Routers then deliver packets to the “nearest” (topologically closest) host advertising that address.  This is widely used for redundancy and load balancing (e.g. public DNS servers, CDNs) ([Anycast - Wikipedia](https://en.wikipedia.org/wiki/Anycast#:~:text=Anycast%20is%20a%20network%20addressing,content%20closer%20to%20end%20users)). For example, a DNS anycast address 198.51.100.1 might be hosted in many cities; a user’s query is routed to the closest instance. (From the host’s point of view it’s just a unicast IP; the routing system makes it “anycast.”)  

#### Quick Notes:
- **Broadcast:** Delivers to *all* hosts on the subnet. The last address in any IPv4 subnet (all host bits 1) is its broadcast (e.g. XXX.255 in a /24). A packet to this address reaches every interface in the subnet.  
- **Multicast:** Delivers to *group* members. Uses 224.0.0.0/4 range ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=One%20of%20the%20differences%20between,255%20range%20for%20IP%20multicast)).  Requires IGMP group membership. Does *not* use broadcast by default.  
- **Anycast:** Delivers to *one of many* – the nearest host among a set sharing an IP ([Anycast - Wikipedia](https://en.wikipedia.org/wiki/Anycast#:~:text=Anycast%20is%20a%20network%20addressing,content%20closer%20to%20end%20users)). Used in place of anycast-capable unicast addresses; routers direct based on topology.  

## Special-Use IPv4 Addresses

Several IPv4 addresses have special meanings:

- **0.0.0.0:** This address means “unspecified” or “this network.”  Used as a source address by hosts during startup (e.g. DHCP clients) meaning “no address yet.”  As a route, 0.0.0.0/0 denotes the default route (all networks) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Special%20address%20blocks%20%20Address,network%5B%204)).  
- **127.0.0.0/8 (Loopback):** All addresses from 127.0.0.0 to 127.255.255.255 are reserved for loopback.  The most common is 127.0.0.1.  Packets sent to any 127.x address loop back to the sending host; they never appear on the network ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=127,Used%20for%20%20215%20link)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20class%20A%20network%20127,destination%20address%20must%20be%20dropped)).  
- **169.254.0.0/16 (Link-Local):** Autoconfiguration (APIPA).  If a host cannot obtain an IP via DHCP, it may assign itself an address in 169.254.x.x ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=169,normally%20been%20retrieved%20from%20a)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=RFC%203927%20defines%20the%20special,or%20other%20internal%20configuration%20methods)). These addresses are only valid on the local link; routers do not forward them.  
- **Broadcast:** 255.255.255.255 is the *limited broadcast* (local link broadcast) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=240,destination%20address%5B%204)).  It reaches all hosts on the local network.  
- **Private Networks:** (Already noted) 10/8, 172.16/12, 192.168/16 ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=network,Used%20for%20%20215%20link)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=Reserved%20private%20IPv4%20network%20ranges,of%20256%20Class%20C%20blocks)), non-routable.  
- **Multicast:** 224.0.0.0–239.255.255.255 (Class D) ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=One%20of%20the%20differences%20between,255%20range%20for%20IP%20multicast)) used for IP multicast groups.  
- **Other:** Special blocks exist for documentation and future use (e.g. 192.0.2.0/24, 198.51.100.0/24, 240.0.0.0/4, etc.), but the main ones above are most commonly encountered.

Each of these addresses has a defined scope/use by IETF/IANA.  For example, the loopback range ensures software can reliably send to “localhost” without leaving the host ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=The%20class%20A%20network%20127,destination%20address%20must%20be%20dropped)).

## IPv4 Security Issues

IPv4 was not designed with strong security in mind. Some major vulnerabilities include:

- **IP Spoofing:** IPv4 packets can carry any source IP address, and routers generally do not verify it. Attackers often forge the source address to impersonate another host or hide their identity ([IP Spoofing & Spoof Attacks](https://www.kaspersky.com/resource-center/threats/ip-spoofing#:~:text=IP%20spoofing%2C%20or%20IP%20address,89%2C%20or%20crashing%20your%20server)). Common attacks like DDoS floods or “Smurf” attacks exploit spoofing to amplify traffic (reflected off others) or to evade filters. In essence, there is no built-in authentication in IPv4 headers.  
- **BGP Hijacking:** Since routing (BGP) has no strong verification, an attacker (or misconfigured ISP) can announce IP prefixes they don’t own. This “route hijack” directs global traffic for those addresses to the wrong place ([What is IPv4 addressing and the limitation of the IPv4 protocol?](https://bunny.net/academy/network/what-is-IPv4-addressing-and-the-limitation-of-the-protocol/#:~:text=IPv4%20address%20hijacking%20depends%20on,citizens%E2%80%99%20access%20to%20certain%20internet)). BGP hijacks have disrupted Internet services or been used by governments for censorship (hijacking an IP block to blackhole addresses) ([What is IPv4 addressing and the limitation of the IPv4 protocol?](https://bunny.net/academy/network/what-is-IPv4-addressing-and-the-limitation-of-the-protocol/#:~:text=IPv4%20address%20hijacking%20depends%20on,citizens%E2%80%99%20access%20to%20certain%20internet)).  
- **DDoS Attacks:** Distributed Denial-of-Service often uses spoofed IPs and leverage reflectors/amplifiers. E.g., sending UDP packets with a victim’s IP as source to many servers causes all replies to flood the victim. IPv4 by itself offers no mitigation.  
- **Lack of Encryption/Integrity:** IPv4 has no mandatory encryption or message integrity. All IP payloads are sent in cleartext (unless a higher-layer like TLS is used). IPsec exists but is optional. Without IPsec (or other measures), an attacker on-path can sniff or alter IPv4 traffic.  
- **ICMP and Scanning:** Tools like ping/ICMP and traceroute can probe networks.  Attackers can map network topologies and discover hosts. (Some admins disable ICMP, but that can break path-MTU discovery.)  

Overall, IPv4’s design trusts that networks are secure at the edge. In modern practice, secure extensions (IPsec VPNs, TCP SSL/TLS, firewalls, etc.) are needed to protect communications. 

#### Quick Notes:
- **Spoofing is easy:** The network layer can’t tell if a packet’s source IP is fake ([IP Spoofing & Spoof Attacks](https://www.kaspersky.com/resource-center/threats/ip-spoofing#:~:text=IP%20spoofing%2C%20or%20IP%20address,89%2C%20or%20crashing%20your%20server)). Always validate critical packets at the endpoints.  
- **DNS/SPF/DMARC** and other measures partially mitigate spoofing on specific protocols (e.g. email).  
- **IPv6 Improvements:** IPv6 integrates more security (mandatory IPsec support, no broadcast, better multicast scoping), but it still inherits similar topology and trust issues; careful configuration is still required.  

## IPv4 vs IPv6 (High-Level)

IPv6 is the successor to IPv4, addressing its limitations.  At a high level, the differences are:

- **Address size:** IPv4 uses 32-bit addresses; IPv6 uses 128-bit addresses (written as 8 groups of hex) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=efficiency,bits%20of%200s%20and%201s)).  IPv6’s 2^128 space is effectively unlimited, solving address exhaustion.  
- **Header format:** IPv4 header is 20–60 bytes with many fields and a checksum. IPv6 header is 40 bytes fixed, without a header checksum and with fewer fields (no options – they became extension headers) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=integrity.%20,has%20led%20to%20the%20development)).  IPv6 also fixes flows with a “Flow Label” field and mandates simplicity for routers.  
- **No NAT:** IPv6 was designed for end-to-end addressing. It omits NAT (and broadcasting). Every device can have a globally unique IPv6 address. (NAT is generally discouraged in IPv6.)  
- **Autoconfiguration:** IPv6 supports stateless address autoconfiguration (SLAAC) and mandatory link-local addressing. IPv4 has DHCP or link-local (169.254.x.x) on client side, but IPv6’s mechanisms are more robust.  
- **Security:** IPv6 originally mandated IPsec support, making it easier to secure by default.  IPv4 can use IPsec but it’s optional ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=,as%20IPSec%20for%20secure%20communications)).  IPv6’s larger header space and multicast usage also change some attack surfaces.  
- **Broadcast:** IPv6 has **no broadcast** address; it uses multicast for all-neighbor queries.  (This reduces unnecessary traffic.)  IPv4’s broadcast model often amplified attacks (e.g. Smurf).  
- **Migration:** IPv4 and IPv6 co-exist via dual-stack, tunneling, or translation. Ultimately, IPv6 is meant to replace IPv4, but as of now both run in parallel ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=efficiency,bits%20of%200s%20and%201s)).  

#### Quick Notes:
- **Primary driver for IPv6:** IPv4 address exhaustion. IPv6 vastly expands the address space (from 4.3×10^9 to 3.4×10^38 addresses) ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=IPv4%20address%20exhaustion%20is%20the,IPv6%20coexist%20on%20the%20Internet)) ([Difference Between IPv4 and IPv6 | GeeksforGeeks](https://www.geeksforgeeks.org/differences-between-ipv4-and-ipv6/#:~:text=efficiency,bits%20of%200s%20and%201s)).  
- **Notation:** IPv4 uses dotted decimal (e.g. 192.168.1.1); IPv6 uses hexadecimal colon-separated (e.g. 2001:0db8::1).  
- **Coexistence:** Transition strategies include dual-stack hosts, tunneling IPv6 over IPv4, or proxying. But long-term we expect IPv6-only deployments where possible.  

**Sources:** This summary is based on authoritative networking references and standards for IPv4 (see cited RFCs and textbooks). All IPv4-specific statements above are supported by networking literature ([Demystifying IPv4: The Backbone of Internet Protocol - What is my IP](https://whatismyip.org/blog/what-is-ipv4/#:~:text=IPv4%20addresses%20are%20composed%20of,known%20as%20%E2%80%9Cdotted%20decimal%E2%80%9D%20notation)) ([IPv4 address exhaustion - Wikipedia](https://en.wikipedia.org/wiki/IPv4_address_exhaustion#:~:text=The%20anticipated%20shortage%20has%20been,2)) ([Difference Between Network Address Translation (NAT) and Port Address Translation (PAT) | GeeksforGeeks](https://www.geeksforgeeks.org/difference-between-network-address-translation-nat-and-port-address-translation-pat/#:~:text=It%20is%20a%20Private%20IP,one%20relation)) ([IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#:~:text=datagrams%20must%20be%20fragmented,trace%20datagrams%20with%20spoofed%20source)) ([Multicast IP Addresses Overview](https://networklessons.com/multicast/multicast-addresses#:~:text=One%20of%20the%20differences%20between,255%20range%20for%20IP%20multicast)) ([Anycast - Wikipedia](https://en.wikipedia.org/wiki/Anycast#:~:text=Anycast%20is%20a%20network%20addressing,content%20closer%20to%20end%20users)), ensuring up-to-date and accurate coverage of IPv4 architecture, header fields, addressing, and operations. The content is tailored for computer networking students, combining narrative explanations with bullet points, formulas, and diagrams for clarity.  